{% extends 'jobboard/base.html' %}
{% load jobboard_tags w3_tags static %}
{% block head_title %}VeraOracle - Profile {% endblock %}

{% block content %}
    {{ block.super }}
    <div class="uk-container uk-align-center">
        <h2 data-hint="profile_head">{{ object.user.username|title }} profile</h2>
        <div uk-grid>
            <div class="uk-width-1-5">
                <div>
                    {% with object.profile.photo as photo %}
                        {% if photo %}
                            <img class="uk-border-rounded" style="width: 100%" src="{{ photo.url }}"/>
                        {% else %}
                            <img class="uk-border-rounded" style="width: 100%;"
                                 src="https://blog.stylingandroid.com/wp-content/themes/lontano-pro/images/no-image-slide.png"
                                 alt="">
                        {% endif %}
                    {% endwith %}
                </div>
            </div>
            <div class="uk-width-4-5">
                <table data-hint="main_info" class="uk-table uk-table-divider uk-table-small" width="100%">
                    <colgroup>
                        <col width="20%">
                        <col width="80%">
                    </colgroup>
                    <tr>
                        <td>Name:</td>
                        <td>{{ object.full_name }}</td>
                    </tr>
                    <tr>
                        <td>Tax number:</td>
                        <td>{{ object.tax_number }}</td>
                    </tr>
                    {% with object.profile as profile %}
                        <tr>
                            <td>Info:</td>
                            <td>
                                <div>
                                    {{ profile.sex|title }}{% if profile.birth_date %},
                                        {{ profile.birth_date|date:'d E Y' }}
                                        year of
                                        birth{% endif %}{% if profile.level %}, education level:
                                        {{ profile.level.title|lower }}{% endif %}
                                </div>
                                <div>
                                    {{ profile.address|title }}{% if profile.relocation %}, ready for
                                        transfer{% endif %}{% if profile.official_journey %}, ready for official
                                        journey{% endif %}
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Languages:</td>
                            <td>{% with profile.languages.all as langs %}
                                {% for lang in langs %}
                                    <span class="uk-badge"
                                          uk-tooltip="{{ lang.get_level_display }}">{{ lang.language.name|title }}</span>
                                {% endfor %}
                            {% endwith %}
                            </td>
                        </tr>
                        <tr>
                            <td>Citizenship:</td>
                            <td>
                                {% with profile.citizenship.all as citiz %}
                                    {% for cit in citiz %}
                                        <span class="uk-badge">{{ cit.country.name|title }}</span>
                                    {% endfor %}
                                {% endwith %}
                            </td>
                        </tr>
                        <tr>
                            <td>Work permit:</td>
                            <td>
                                {% with profile.work_permit.all as permits %}
                                    {% for permit in permits %}
                                        <span class="uk-badge">{{ permit.country.name|title }}</span>
                                    {% endfor %}
                                {% endwith %}
                            </td>
                        </tr>
                    {% endwith %}

                    {% if object.contract_address is not None %}
                        <tr data-hint="contract_address">
                            <td>Contract address:</td>
                            <td>
                                <img style="width: 16px; height: 16px;"
                                     src="{{ object.contract_address|get_blockies_png }}" alt="">
                                <a class="uk-link-reset" target="_blank"
                                   href="https://rinkeby.etherscan.io/address/{{ object.contract_address }}">{{ object.contract_address }}</a>
                            </td>
                        </tr>
                    {% endif %}
                </table>
            </div>
        </div>
        <hr class="uk-divider-icon">
        <div>
            {% with object.profile as profile %}
                {% if profile.position %}
                    <div class="uk-article">
                        <p class="uk-text-lead">{{ profile.position.title }}</p>
                        Salary from: {{ profile.position.salary_from }}$
                        <ul class="uk-list uk-list-bullet">
                            <li>{{ profile.position.busyness.all|join:', ' }}</li>
                            <li>{{ profile.position.schedule.all|join:', ' }}</li>
                        </ul>
                        {% if profile.position.description %}
                            <p>
                                {{ profile.position.description|safe }}
                            </p>
                        {% endif %}
                        {% if profile.position.carier_start %}
                            <div class="chip blue white-text uk-align-right">Career start</div>
                        {% endif %}
                    </div>
                    <hr class="uk-divider-icon">
                {% endif %}
                {% with profile.experience.all as experiences %}
                    {% if experiences %}
                        <div>
                            <p class="uk-text-lead">Experience</p>
                            {% for experience in experiences %}
                                {% include 'candidateprofile/include/experience.html' %}
                            {% endfor %}
                        </div>
                        <hr class="uk-divider-icon">
                    {% endif %}
                {% endwith %}
                {% with profile.education.all as educations %}
                    {% if educations %}
                        <div>
                            <p class="uk-text-lead">Education</p>
                            {% for education in educations %}
                                {% include 'candidateprofile/include/education.html' %}
                            {% endfor %}
                        </div>
                        <hr class="uk-divider-icon">
                    {% endif %}
                {% endwith %}
            {% endwith %}
        </div>
        {% for item in object.profile.specialisations.all %}
            <div class="chip">{{ item }}</div>
        {% endfor %}
        {% if not user.is_authenticated %}
            {% include 'jobboard/include/login_modal.html' %}
        {% elif role == 'employer' %}
            <div class="uk-clearfix"></div>
            {% if role_object.vacancies.count > 0 %}
                <button class="uk-button uk-button-default uk-button-small uk-align-right"
                        uk-toggle="target: #offer_modal">
                    Offer a vacancy
                </button>
                <div id="offer_modal" uk-modal>
                    <div class="uk-modal-dialog">
                        <button class="uk-modal-close-default" type="button" uk-close></button>
                        <div class="uk-modal-header">
                            <h2 class="uk-modal-title">Select vacancy</h2>
                        </div>
                        <div>
                            {% for vac in role_object.vacancies %}
                                {% include 'vacancy/vacancy_short.html' with item=vac selectable=True cv=object.profile %}
                            {% endfor %}
                        </div>
                        <div class="uk-modal-footer uk-text-right">
                            <button class="uk-button uk-button-small uk-button-default uk-modal-close" type="button">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            {% else %}
                <a href="{% url 'new_vacancy' %}" class="uk-button uk-button-primary uk-button-small uk-align-right">
                    Create vacancy
                </a>
            {% endif %}
        {% endif %}

    </div>
{% endblock %}


