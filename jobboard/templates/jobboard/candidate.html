{% extends 'jobboard/base.html' %}
{% load jobboard_tags w3_tags static %}
{% block head_title %}VeraOracle - Profile {% endblock %}

{% block content %}
    {{ block.super }}
    <div class="uk-container uk-align-center uk-margin-large-bottom">
        <h4 data-hint="uk-text-bold">{{ object.user.username|title }} profile</h4>
        <div class="uk-margin-large-top" data-uk-grid>
            <div class="uk-width-3-4">
                <ul data-uk-tab="connect: #profile_contrainer">
                    <li class="uk-active"><a class="uk-text-capitalize" href="#">Profile</a></li>
                    <li><a class="uk-text-capitalize" href="#">Facts</a></li>
                    <li><a class="uk-text-capitalize" href="#">Achievements</a></li>
                    {% with object.profile as profile %}
                        {% if profile.position %}
                            <li><a class="uk-text-capitalize" href="#">Position</a></li>
                        {% endif %}
                        {% with profile.experience.exists as experiences %}
                            {% if experiences %}
                                <li><a class="uk-text-capitalize" href="#">Experience</a></li>
                            {% endif %}
                        {% endwith %}
                        {% with profile.education.exists as educations %}
                            {% if educations %}
                                <li><a class="uk-text-capitalize" href="#">Education</a></li>
                            {% endif %}
                        {% endwith %}
                    {% endwith %}
                </ul>
            </div>
        </div>
        <div class="uk-margin-top-small uk-margin-large-bottom" data-uk-grid>
            <div class="uk-width-3-4">
                <div class="vr-window white uk-padding-small">
                    <ul id="profile_contrainer" class="uk-switcher">
                        <li>
                            <div data-uk-grid>
                                <div class="uk-width-1-5">
                                    <div>
                                        {% with object.profile.photo as photo %}
                                            {% if photo %}
                                                <img class="uk-border-rounded" style="width: 100%"
                                                     src="{{ photo.url }}"/>
                                            {% else %}
                                                <img class="uk-border-rounded" style="width: 100%;"
                                                     src="https://blog.stylingandroid.com/wp-content/themes/lontano-pro/images/no-image-slide.png"
                                                     alt="">
                                            {% endif %}
                                        {% endwith %}
                                    </div>
                                </div>
                                <div class="uk-width-4-5">
                                    <table data-hint="main_info" class="uk-table uk-table-divider uk-table-small"
                                           width="100%">
                                        <colgroup>
                                            <col width="30%">
                                            <col width="70%">
                                        </colgroup>
                                        <tr>
                                            <td>Name:</td>
                                            <td>{{ object.full_name }}</td>
                                        </tr>
                                        <tr>
                                            <td>Tax number:</td>
                                            <td>{{ object.tax_number }}</td>
                                        </tr>
                                        {% with object.profile as profile %}
                                            <tr>
                                                <td>Info:</td>
                                                <td>
                                                    <div>
                                                        {{ profile.sex|title }}{% if profile.birth_date %},
                                                            {{ profile.birth_date|date:'d E Y' }}
                                                            year of
                                                            birth{% endif %}{% if profile.level %}, education level:
                                                            {{ profile.level.title|lower }}{% endif %}
                                                    </div>
                                                    <div>
                                                        {{ profile.address|title }}{% if profile.relocation %}, ready
                                                            for
                                                            transfer{% endif %}{% if profile.official_journey %}, ready
                                                            for
                                                            official
                                                            journey{% endif %}
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Languages:</td>
                                                <td>{% with profile.languages.all as langs %}
                                                    {% for lang in langs %}
                                                        <span class="uk-badge"
                                                              data-uk-tooltip="{{ lang.get_level_display }}">{{ lang.language.name|title }}</span>
                                                    {% empty %}
                                                        not indicated
                                                    {% endfor %}
                                                {% endwith %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Citizenship:</td>
                                                <td>
                                                    {% with profile.citizenship.all as citiz %}
                                                        {% for cit in citiz %}
                                                            <span class="uk-badge">{{ cit.country.name|title }}</span>
                                                        {% empty %}
                                                            not indicated
                                                        {% endfor %}

                                                    {% endwith %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Work permit:</td>
                                                <td>
                                                    {% with profile.work_permit.all as permits %}
                                                        {% for permit in permits %}
                                                            <span class="uk-badge">{{ permit.country.name|title }}</span>
                                                        {% empty %}
                                                            not indicated
                                                        {% endfor %}

                                                    {% endwith %}
                                                </td>
                                            </tr>
                                        {% endwith %}

                                        {% if object.contract_address is not None %}
                                            <tr data-hint="contract_address">
                                                <td>Contract address:</td>
                                                <td>
                                                    <img style="width: 16px; height: 16px;"
                                                         src="{{ object.contract_address|get_blockies_png }}" alt="">
                                                    <a class="uk-link-reset" target="_blank"
                                                       href="https://rinkeby.etherscan.io/address/{{ object.contract_address }}">{{ object.contract_address }}</a>
                                                </td>
                                            </tr>
                                        {% endif %}
                                    </table>
                                    {% for item in object.profile.specialisations.all %}
                                        <div class="chip vr-chip-border white blue-text text-lighten-2">{{ item }}</div>
                                    {% endfor %}
                                </div>
                            </div>

                        </li>
                        <li>
                            {% get_facts object %}
                        </li>
                        <li>
                            {% with object.achievements.all as achievements %}
                                <ul data-uk-accordion="multiple: true">
                                    {% if achievements %}
                                        {% for achievement in achievements %}
                                            <li class="uk-border uk-padding-small">
                                                <a class="uk-accordion-title" href="#">{{ achievement.title }}</a>
                                                <div class="uk-accordion-content">
                                                    {{ achievement.text|safe }}
                                                </div>
                                            </li>
                                        {% endfor %}
                                    {% else %}
                                        <li class="uk-border uk-padding-small">
                                            <a class="uk-accordion-title" href="#">Achievements not added yet.</a>
                                        </li>
                                    {% endif %}
                                </ul>
                            {% endwith %}
                        </li>
                        {% with object.profile as profile %}
                            {% if profile.position %}
                                <li>
                                    <div class="uk-article">
                                        <p class="uk-text-lead">{{ profile.position.title }}</p>
                                        Salary from: {{ profile.position.salary_from }}$
                                        <ul class="uk-list uk-list-bullet">
                                            <li>{{ profile.position.busyness.all|join:', ' }}</li>
                                            <li>{{ profile.position.schedule.all|join:', ' }}</li>
                                        </ul>
                                        {% if profile.position.description %}
                                            <p>
                                                {{ profile.position.description|safe }}
                                            </p>
                                        {% endif %}
                                        {% if profile.position.carier_start %}
                                            <div class="chip blue-text white text-lighten-2 vr-chip-border uk-align-right">
                                                Career start
                                            </div>
                                        {% endif %}
                                    </div>
                                </li>
                            {% endif %}
                            {% with profile.experience.all as experiences %}
                                {% if experiences %}
                                    <li>
                                        <div>
                                            {% for experience in experiences %}
                                                {% include 'candidateprofile/include/experience.html' %}
                                            {% endfor %}
                                        </div>
                                    </li>
                                {% endif %}
                            {% endwith %}
                            {% with profile.education.all as educations %}
                                {% if educations %}
                                    <li>
                                        <div>
                                            {% for education in educations %}
                                                {% include 'candidateprofile/include/education.html' %}
                                            {% endfor %}
                                        </div>
                                    </li>
                                {% endif %}
                            {% endwith %}
                        {% endwith %}
                    </ul>
                </div>
            </div>
            <div class="uk-width-1-4">
                <div class="vr-window white uk-padding-small">
                    {% if not user.is_authenticated %}
                        {% include 'jobboard/include/login_modal.html' %}
                    {% elif role == 'employer' %}
                        <h5 class="uk-text-bold">Actions</h5>
                        {% if role_object.vacancies.count > 0 %}
                            <button class="uk-button uk-button-primary uk-button-small uk-align-center uk-margin-remove-bottom"
                                    data-uk-toggle="target: #offer_modal">
                                Offer a vacancy
                            </button>
                            <div class="uk-clearfix"></div>
                            <div id="offer_modal" data-uk-modal>
                                <div class="uk-modal-dialog">
                                    <button class="uk-modal-close-default" type="button" data-uk-close></button>
                                    <div class="uk-modal-header">
                                        <h4 class="uk-modal-title">Select vacancy</h4>
                                    </div>
                                    <div>
                                        {% for vac in role_object.vacancies %}
                                            {% include 'vacancy/vacancy_short.html' with item=vac selectable=True cv=object.profile %}
                                        {% endfor %}
                                    </div>
                                    <div class="uk-modal-footer uk-text-right">
                                        <button class="uk-button uk-button-small uk-button-default uk-modal-close"
                                                type="button">
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <a href="{% url 'new_vacancy' %}"
                               class="uk-button uk-button-primary uk-button-small">Create vacancy</a>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>

    </div>
{% endblock %}


