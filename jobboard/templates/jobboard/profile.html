{% extends 'jobboard/base.html' %}
{% load jobboard_tags w3_tags %}
{% block head_title %}VeraOracle - Profile {% endblock %}

{% block content %}
    <div class="row">
        <div class="col s12 m10 l10 push-l1 push-m1">
            <h4 class="center">{{ role|title }} info</h4>
            {% if obj.contract_address %}
                {% with obj.enabled as en %}
                    <div class="chip white-text right {% if en == True %}red{% elif en == False %}green{% else %}amber{% endif %}">
                        {% if en != None %}
                            <a disabled class="white-text underline" href="{% url 'change_contract_status' %}">
                                {% if en == True %}
                                    Disable contract
                                {% else %}
                                    Enable contract
                                {% endif %}
                            </a>
                        {% else %}
                            Renewal of contract status...<i class="fa fa-circle-o-notch fa-spin fa-1x fa-fw"></i>
                        {% endif %}
                    </div>
                {% endwith %}
            {% endif %}
            {% if role == 'candidate' %}
                <table class="bordered highlight" width="100%">
                    <colgroup>
                        <col width="20%">
                        <col width="80%">
                    </colgroup>
                    <tr>
                        <td>Name:</td>
                        <td>{{ obj.first_name }}</td>
                    </tr>
                    <tr>
                        <td>Last name:</td>
                        <td>{{ obj.last_name }}</td>
                    </tr>
                    <tr>
                        <td>Middle name:</td>
                        <td>{{ obj.middle_name|default:'-' }}</td>
                    </tr>
                    <tr>
                        <td>Tax number:</td>
                        <td>{{ obj.tax_number }}</td>
                    </tr>
                    <tr>
                        <td>Contract address:</td>
                        <td>
                            {% if obj.contract_address is not None %}
                                <a target="_blank"
                                   href="https://rinkeby.etherscan.io/address/{{ obj.contract_address }}">{{ obj.contract_address }}</a>
                            {% else %}
                                Pending...<i class="fa fa-circle-o-notch fa-spin fa-1x fa-fw"></i>
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td>Balance:</td>
                        <td>
                            {% get_balance obj.user obj.contract_address %}
                        </td>
                    </tr>
                </table>
                {% if cv %}
                    <h5>My Curriculum vitae</h5>
                    {% include 'cv/include/cv.html' %}
                    <a class="btn waves-effect waves-light right amber white-text" href="{% url 'new_cv' %}">Add new
                        curriculum vitae</a>
                    <div class="clearfix"></div>
                {% endif %}
                {% if obj.contract_address %}
                    {% get_facts obj %}
                    {% get_candidate_vacancies obj request %}
                {% endif %}
            {% elif role == 'employer' %}
                <table class="bordered highlight" width="100%">
                    <colgroup>
                        <col width="20%">
                        <col width="80%">
                    </colgroup>
                    <tr>
                        <td>Organization:</td>
                        <td>{{ obj.organization }}</td>
                    </tr>
                    <tr>
                        <td>Tax number:</td>
                        <td>{{ obj.tax_number }}</td>
                    </tr>
                    <tr>
                        <td>Contract address:</td>
                        <td>
                            {% if obj.contract_address is not None %}
                                <a target="_blank"
                                   href="https://rinkeby.etherscan.io/address/{{ obj.contract_address }}">{{ obj.contract_address }}</a>
                            {% else %}
                                Pending...<i class="fa fa-circle-o-notch fa-spin fa-1x fa-fw"></i>
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td>Balance:</td>
                        <td>
                            {% get_balance obj.user obj.contract_address %}
                        </td>
                    </tr>
                </table>
                {% if vacancies %}
                    <h5>Your vacancies</h5>
                    {% for vacancy in vacancies %}
                        {% include 'vacancy/vacancy_short.html' with item=vacancy %}
                    {% endfor %}
                {% endif %}
                <div class="right">
                    {% if vacancies_count > 3 %}
                        <a class="btn waves-effect blue" href="{% url 'vacancy_all' %}">All vacancies</a>
                    {% endif %}
                    {% if obj.contract_address and obj.enabled == True %}
                        <a class="btn waves-effect amber" href="{% url 'new_vacancy' %}">Create new vacancy</a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}